/*
 *  Driver for Faraday GC1610 pin controller
 *
 *  Copyright (C) 2022 Faraday Technology
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 2 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 */
 
#include <linux/init.h>
#include <linux/module.h>
#include <linux/of.h>
#include <linux/platform_device.h>
#include <linux/pinctrl/pinctrl.h>

#include "pinctrl-ftscu010.h"

#define GC1610_PMUR_MFS0  0x844
#define GC1610_PMUR_MFS1  0x848
#define GC1610_PMUR_MFS2  0x84c
#define GC1610_PMUR_MFS3  0x850

/* Pins */
enum{
	GC1610_PIN_X_CPU_TRSTn,
	GC1610_PIN_X_CPU_TCK,
	GC1610_PIN_X_CPU_TMS,
	GC1610_PIN_X_CPU_TDI,
	GC1610_PIN_X_CPU_TDO,
	GC1610_PIN_X_RGM_TXCLK_IN,
	GC1610_PIN_X_TX_SD,
	GC1610_PIN_X_RX_LOS,
	GC1610_PIN_X_PON_BEN,
	GC1610_PIN_X_TX_PWRDOWN,
	GC1610_PIN_X_RX_PWRDOWN,
	GC1610_PIN_X_XGMII_LOS,
	GC1610_PIN_X_SPI_SCLK,
	GC1610_PIN_X_SPI_CS,
	GC1610_PIN_X_SPI_SIO0,
	GC1610_PIN_X_SPI_SIO1,
	GC1610_PIN_X_SPI_SIO2,
	GC1610_PIN_X_SPI_SIO3,
	GC1610_PIN_X_RGM_TXCLK,
	GC1610_PIN_X_RGM_TXCTL,
	GC1610_PIN_X_RGM_TXD0,
	GC1610_PIN_X_RGM_TXD1,
	GC1610_PIN_X_RGM_TXD2,
	GC1610_PIN_X_RGM_TXD3,
	GC1610_PIN_X_RGM_RXD0,
	GC1610_PIN_X_RGM_RXD1,
	GC1610_PIN_X_RGM_RXD2,
	GC1610_PIN_X_RGM_RXD3,
	GC1610_PIN_X_RGM_RXCTL,
	GC1610_PIN_X_RGM_RXCLK,
	GC1610_PIN_X_PCM_CLK,
	GC1610_PIN_X_PCM_FS,
	GC1610_PIN_X_PCM_TXD,
	GC1610_PIN_X_PCM_RXD,
	GC1610_PIN_X_UART0_RX,
	GC1610_PIN_X_UART0_TX,
	GC1610_PIN_X_UART1_RX,
	GC1610_PIN_X_UART1_TX,
	GC1610_PIN_X_I2C0_SCL,
	GC1610_PIN_X_I2C0_SDA,
	GC1610_PIN_X_I2C1_SCL,
	GC1610_PIN_X_I2C1_SDA,
	GC1610_PIN_X_SSP_CS0,
	GC1610_PIN_X_SSP_CS1,
	GC1610_PIN_X_SSP_CS2,
	GC1610_PIN_X_SSP_CS3,
	GC1610_PIN_X_SSP_TXD,
	GC1610_PIN_X_SSP_RXD,
	GC1610_PIN_X_SSP_SCLK,
	GC1610_PIN_X_MDC,
	GC1610_PIN_X_MDIO,
	GC1610_PIN_X_RST_OUT,
	GC1610_PIN_X_PCIe0_RST,
	GC1610_PIN_X_PCIe0_nCLKREQ,
	GC1610_PIN_X_PCIe1_RST,
	GC1610_PIN_X_PCIe1_nCLKREQ,
	GC1610_PIN_X_GPIO0,
	GC1610_PIN_X_GPIO1,
	GC1610_PIN_X_GPIO2,
	GC1610_PIN_X_GPIO3,
	GC1610_PIN_X_GPIO4,
	GC1610_PIN_X_GPIO5,
	GC1610_PIN_X_GPIO6,
	GC1610_PIN_X_GPIO7,
};

#define GC1610_PINCTRL_PIN(x) PINCTRL_PIN(GC1610_PIN_ ## x, #x)

static const struct pinctrl_pin_desc gc1610_pins[] = {
	GC1610_PINCTRL_PIN(X_CPU_TRSTn),
	GC1610_PINCTRL_PIN(X_CPU_TCK),
	GC1610_PINCTRL_PIN(X_CPU_TMS),
	GC1610_PINCTRL_PIN(X_CPU_TDI),
	GC1610_PINCTRL_PIN(X_CPU_TDO),
	GC1610_PINCTRL_PIN(X_RGM_TXCLK_IN),
	GC1610_PINCTRL_PIN(X_TX_SD),
	GC1610_PINCTRL_PIN(X_RX_LOS),
	GC1610_PINCTRL_PIN(X_PON_BEN),
	GC1610_PINCTRL_PIN(X_TX_PWRDOWN),
	GC1610_PINCTRL_PIN(X_RX_PWRDOWN),
	GC1610_PINCTRL_PIN(X_XGMII_LOS),
	GC1610_PINCTRL_PIN(X_SPI_SCLK),
	GC1610_PINCTRL_PIN(X_SPI_CS),
	GC1610_PINCTRL_PIN(X_SPI_SIO0),
	GC1610_PINCTRL_PIN(X_SPI_SIO1),
	GC1610_PINCTRL_PIN(X_SPI_SIO2),
	GC1610_PINCTRL_PIN(X_SPI_SIO3),
	GC1610_PINCTRL_PIN(X_RGM_TXCLK),
	GC1610_PINCTRL_PIN(X_RGM_TXCTL),
	GC1610_PINCTRL_PIN(X_RGM_TXD0),
	GC1610_PINCTRL_PIN(X_RGM_TXD1),
	GC1610_PINCTRL_PIN(X_RGM_TXD2),
	GC1610_PINCTRL_PIN(X_RGM_TXD3),
	GC1610_PINCTRL_PIN(X_RGM_RXD0),
	GC1610_PINCTRL_PIN(X_RGM_RXD1),
	GC1610_PINCTRL_PIN(X_RGM_RXD2),
	GC1610_PINCTRL_PIN(X_RGM_RXD3),
	GC1610_PINCTRL_PIN(X_RGM_RXCTL),
	GC1610_PINCTRL_PIN(X_RGM_RXCLK),
	GC1610_PINCTRL_PIN(X_PCM_CLK),
	GC1610_PINCTRL_PIN(X_PCM_FS),
	GC1610_PINCTRL_PIN(X_PCM_TXD),
	GC1610_PINCTRL_PIN(X_PCM_RXD),
	GC1610_PINCTRL_PIN(X_UART0_RX),
	GC1610_PINCTRL_PIN(X_UART0_TX),
	GC1610_PINCTRL_PIN(X_UART1_RX),
	GC1610_PINCTRL_PIN(X_UART1_TX),
	GC1610_PINCTRL_PIN(X_I2C0_SCL),
	GC1610_PINCTRL_PIN(X_I2C0_SDA),
	GC1610_PINCTRL_PIN(X_I2C1_SCL),
	GC1610_PINCTRL_PIN(X_I2C1_SDA),
	GC1610_PINCTRL_PIN(X_SSP_CS0),
	GC1610_PINCTRL_PIN(X_SSP_CS1),
	GC1610_PINCTRL_PIN(X_SSP_CS2),
	GC1610_PINCTRL_PIN(X_SSP_CS3),
	GC1610_PINCTRL_PIN(X_SSP_TXD),
	GC1610_PINCTRL_PIN(X_SSP_RXD),
	GC1610_PINCTRL_PIN(X_SSP_SCLK),
	GC1610_PINCTRL_PIN(X_MDC),
	GC1610_PINCTRL_PIN(X_MDIO),
	GC1610_PINCTRL_PIN(X_RST_OUT),
	GC1610_PINCTRL_PIN(X_PCIe0_RST),
	GC1610_PINCTRL_PIN(X_PCIe0_nCLKREQ),
	GC1610_PINCTRL_PIN(X_PCIe1_RST),
	GC1610_PINCTRL_PIN(X_PCIe1_nCLKREQ),
	GC1610_PINCTRL_PIN(X_GPIO0),
	GC1610_PINCTRL_PIN(X_GPIO1),
	GC1610_PINCTRL_PIN(X_GPIO2),
	GC1610_PINCTRL_PIN(X_GPIO3),
	GC1610_PINCTRL_PIN(X_GPIO4),
	GC1610_PINCTRL_PIN(X_GPIO5),
	GC1610_PINCTRL_PIN(X_GPIO6),
	GC1610_PINCTRL_PIN(X_GPIO7),
};


//mark : start from here
/* Pin groups */
static const unsigned ca53d_subsystem_pins[] = {
	GC1610_PIN_X_CPU_TCK,
	GC1610_PIN_X_CPU_TDI,
	GC1610_PIN_X_CPU_TDO,
	GC1610_PIN_X_CPU_TMS,
	GC1610_PIN_X_CPU_TRSTn,
};

static const unsigned ontop_pins[] = {
	GC1610_PIN_X_RGM_TXCLK_IN,
	GC1610_PIN_X_TX_SD,
	GC1610_PIN_X_RX_LOS,
	GC1610_PIN_X_PON_BEN,
	GC1610_PIN_X_TX_PWRDOWN,
	GC1610_PIN_X_RX_PWRDOWN,
	GC1610_PIN_X_RGM_TXCLK,
	GC1610_PIN_X_RGM_TXCTL,
	GC1610_PIN_X_RGM_TXD0,
	GC1610_PIN_X_RGM_TXD1,
	GC1610_PIN_X_RGM_TXD2,
	GC1610_PIN_X_RGM_TXD3,
	GC1610_PIN_X_RGM_RXD0,
	GC1610_PIN_X_RGM_RXD1,
	GC1610_PIN_X_RGM_RXD2,
	GC1610_PIN_X_RGM_RXD3,
	GC1610_PIN_X_RGM_RXCTL,
	GC1610_PIN_X_RGM_RXCLK,
	GC1610_PIN_X_UART1_RX,
	GC1610_PIN_X_I2C1_SCL,
	GC1610_PIN_X_I2C1_SDA,
	GC1610_PIN_X_GPIO2,
	GC1610_PIN_X_XGMII_LOS,
};

static const unsigned ftspi020_pins[] = {
	GC1610_PIN_X_SPI_SCLK,
	GC1610_PIN_X_SPI_CS,
	GC1610_PIN_X_SPI_SIO0,
	GC1610_PIN_X_SPI_SIO1,
	GC1610_PIN_X_SPI_SIO2,
	GC1610_PIN_X_SPI_SIO3,
	GC1610_PIN_X_GPIO0,
};

static const unsigned clk_gen_pins[] = {
	GC1610_PIN_X_GPIO7,
};
static const unsigned ftiic010_pins[] = {
	GC1610_PIN_X_I2C0_SCL,
	GC1610_PIN_X_I2C0_SDA,
};
static const unsigned ftiic010_1_pins[] = {
	GC1610_PIN_X_I2C1_SCL,
	GC1610_PIN_X_I2C1_SDA,
};
static const unsigned ftnandc024_pins[] = {
	GC1610_PIN_X_RGM_RXD0,
	GC1610_PIN_X_RGM_RXD1,
	GC1610_PIN_X_RGM_TXCLK,
	GC1610_PIN_X_RGM_TXCTL,
	GC1610_PIN_X_RGM_TXD0,
	GC1610_PIN_X_RGM_TXD1,
	GC1610_PIN_X_RGM_TXD2,
	GC1610_PIN_X_RGM_TXD3,
	GC1610_PIN_X_SPI_CS,
	GC1610_PIN_X_SPI_SCLK,
	GC1610_PIN_X_SPI_SIO0,
	GC1610_PIN_X_SPI_SIO1,
	GC1610_PIN_X_SPI_SIO2,
	GC1610_PIN_X_SPI_SIO3,
};

static const unsigned ftssp010_pins[] = {
	GC1610_PIN_X_SSP_CS0,
	GC1610_PIN_X_SSP_CS1,
	GC1610_PIN_X_SSP_CS2,
	GC1610_PIN_X_SSP_CS3,
	GC1610_PIN_X_SSP_RXD,
	GC1610_PIN_X_SSP_SCLK,
	GC1610_PIN_X_SSP_TXD,
};
static const unsigned ftuart010_pins[] = {
	GC1610_PIN_X_UART0_RX,
	GC1610_PIN_X_UART0_TX,
};
static const unsigned ftuart010_1_pins[] = {
	GC1610_PIN_X_UART1_RX,
	GC1610_PIN_X_UART1_TX,
};
static const unsigned ftuart010_2_pins[] = {
	GC1610_PIN_X_CPU_TCK,
	GC1610_PIN_X_CPU_TDO,
	GC1610_PIN_X_CPU_TMS,
	GC1610_PIN_X_CPU_TRSTn,
};
#if 0
static const unsigned function mode_pins[] = {
	GC1610_PIN_X_CPU_TCK,
	GC1610_PIN_X_CPU_TDI,
	GC1610_PIN_X_CPU_TDO,
	GC1610_PIN_X_CPU_TMS,
	GC1610_PIN_X_CPU_TRSTn,
	GC1610_PIN_X_GPIO0,
	GC1610_PIN_X_GPIO1,
	GC1610_PIN_X_GPIO2,
	GC1610_PIN_X_GPIO3,
	GC1610_PIN_X_GPIO4,
	GC1610_PIN_X_GPIO5,
	GC1610_PIN_X_GPIO6,
	GC1610_PIN_X_GPIO7,
	GC1610_PIN_X_I2C0_SCL,
	GC1610_PIN_X_I2C0_SDA,
	GC1610_PIN_X_I2C1_SCL,
	GC1610_PIN_X_I2C1_SDA,
	GC1610_PIN_X_MDC,
	GC1610_PIN_X_MDIO,
	GC1610_PIN_X_PCIe0_RST,
	GC1610_PIN_X_PCIe0_nCLKREQ,
	GC1610_PIN_X_PCIe1_RST,
	GC1610_PIN_X_PCIe1_nCLKREQ,
	GC1610_PIN_X_PCM_CLK,
	GC1610_PIN_X_PCM_FS,
	GC1610_PIN_X_PCM_RXD,
	GC1610_PIN_X_PCM_TXD,
	GC1610_PIN_X_PON_BEN,
	GC1610_PIN_X_RGM_RXCLK,
	GC1610_PIN_X_RGM_RXCTL,
	GC1610_PIN_X_RGM_RXD0,
	GC1610_PIN_X_RGM_RXD1,
	GC1610_PIN_X_RGM_RXD2,
	GC1610_PIN_X_RGM_RXD3,
	GC1610_PIN_X_RGM_TXCLK,
	GC1610_PIN_X_RGM_TXCLK_IN,
	GC1610_PIN_X_RGM_TXCTL,
	GC1610_PIN_X_RGM_TXD0,
	GC1610_PIN_X_RGM_TXD1,
	GC1610_PIN_X_RGM_TXD2,
	GC1610_PIN_X_RGM_TXD3,
	GC1610_PIN_X_RST_OUT,
	GC1610_PIN_X_RX_LOS,
	GC1610_PIN_X_RX_PWRDOWN,
	GC1610_PIN_X_SPI_CS,
	GC1610_PIN_X_SPI_SCLK,
	GC1610_PIN_X_SPI_SIO0,
	GC1610_PIN_X_SPI_SIO1,
	GC1610_PIN_X_SPI_SIO2,
	GC1610_PIN_X_SPI_SIO3,
	GC1610_PIN_X_SSP_CS0,
	GC1610_PIN_X_SSP_CS1,
	GC1610_PIN_X_SSP_CS2,
	GC1610_PIN_X_SSP_CS3,
	GC1610_PIN_X_SSP_RXD,
	GC1610_PIN_X_SSP_SCLK,
	GC1610_PIN_X_SSP_TXD,
	GC1610_PIN_X_TX_PWRDOWN,
	GC1610_PIN_X_TX_SD,
	GC1610_PIN_X_UART0_RX,
	GC1610_PIN_X_UART0_TX,
	GC1610_PIN_X_UART1_RX,
	GC1610_PIN_X_UART1_TX,
	GC1610_PIN_X_XGMII_LOS,
};
#endif
static const unsigned glue_pins[] = {
	GC1610_PIN_X_CPU_TDI,
	GC1610_PIN_X_RGM_TXCLK_IN,
};
static const unsigned ftgpio_sel0_pins[] = {
	GC1610_PIN_X_CPU_TRSTn,
	GC1610_PIN_X_CPU_TCK,
	GC1610_PIN_X_CPU_TMS,
	GC1610_PIN_X_CPU_TDI,
	GC1610_PIN_X_CPU_TDO,
	GC1610_PIN_X_RGM_TXCLK_IN,
	GC1610_PIN_X_TX_SD,
	GC1610_PIN_X_RX_LOS,
	GC1610_PIN_X_PON_BEN,
	GC1610_PIN_X_TX_PWRDOWN,
	GC1610_PIN_X_RX_PWRDOWN,
	GC1610_PIN_X_XGMII_LOS,
	GC1610_PIN_X_SPI_SCLK,
	GC1610_PIN_X_SPI_CS,
	GC1610_PIN_X_SPI_SIO0,
	GC1610_PIN_X_SPI_SIO1,
	GC1610_PIN_X_SPI_SIO2,
	GC1610_PIN_X_SPI_SIO3,
	GC1610_PIN_X_RGM_TXCLK,
	GC1610_PIN_X_RGM_TXCTL,
	GC1610_PIN_X_RGM_TXD0,
	GC1610_PIN_X_RGM_TXD1,
	GC1610_PIN_X_RGM_TXD2,
	GC1610_PIN_X_RGM_TXD3,
	GC1610_PIN_X_RGM_RXD0,
	GC1610_PIN_X_RGM_RXD1,
	GC1610_PIN_X_RGM_RXD2,
	GC1610_PIN_X_RGM_RXD3,
	GC1610_PIN_X_RGM_RXCTL,
	GC1610_PIN_X_RGM_RXCLK,
	GC1610_PIN_X_PCM_CLK,
	GC1610_PIN_X_PCM_FS,
};

static const unsigned ftgpio_sel1_pins[] = {
	GC1610_PIN_X_PCM_TXD,
	GC1610_PIN_X_PCM_RXD,
	GC1610_PIN_X_UART0_RX,
	GC1610_PIN_X_UART0_TX,
	GC1610_PIN_X_UART1_RX,
	GC1610_PIN_X_UART1_TX,
	GC1610_PIN_X_I2C0_SCL,
	GC1610_PIN_X_I2C0_SDA,
	GC1610_PIN_X_I2C1_SCL,
	GC1610_PIN_X_I2C1_SDA,
	GC1610_PIN_X_SSP_CS0,
	GC1610_PIN_X_SSP_CS1,
	GC1610_PIN_X_SSP_CS2,
	GC1610_PIN_X_SSP_CS3,
	GC1610_PIN_X_SSP_TXD,
	GC1610_PIN_X_SSP_RXD,
	GC1610_PIN_X_SSP_SCLK,
	GC1610_PIN_X_MDC,
	GC1610_PIN_X_MDIO,
	GC1610_PIN_X_RST_OUT,
	GC1610_PIN_X_PCIe0_RST,
	GC1610_PIN_X_PCIe0_nCLKREQ,
	GC1610_PIN_X_PCIe1_RST,
	GC1610_PIN_X_PCIe1_nCLKREQ,
	GC1610_PIN_X_GPIO0,
	GC1610_PIN_X_GPIO1,
	GC1610_PIN_X_GPIO2,
	GC1610_PIN_X_GPIO3,
	GC1610_PIN_X_GPIO4,
	GC1610_PIN_X_GPIO5,
	GC1610_PIN_X_GPIO6,
	GC1610_PIN_X_GPIO7,
};
static const unsigned isi_inf_pins[] = {
	GC1610_PIN_X_PCM_CLK,
	GC1610_PIN_X_PCM_FS,
	GC1610_PIN_X_PCM_RXD,
	GC1610_PIN_X_PCM_TXD,
};
static const unsigned mdio_master_pins[] = {
	GC1610_PIN_X_MDC,
	GC1610_PIN_X_MDIO,
};
static const unsigned na_pins[] = {
	GC1610_PIN_X_GPIO0,
	GC1610_PIN_X_GPIO1,
	GC1610_PIN_X_GPIO2,
	GC1610_PIN_X_GPIO3,
	GC1610_PIN_X_GPIO4,
	GC1610_PIN_X_GPIO5,
	GC1610_PIN_X_GPIO6,
	GC1610_PIN_X_GPIO7,
	GC1610_PIN_X_I2C0_SCL,
	GC1610_PIN_X_I2C0_SDA,
	GC1610_PIN_X_MDC,
	GC1610_PIN_X_MDIO,
	GC1610_PIN_X_PCIe0_RST,
	GC1610_PIN_X_PCIe0_nCLKREQ,
	GC1610_PIN_X_PCIe1_RST,
	GC1610_PIN_X_PCIe1_nCLKREQ,
	GC1610_PIN_X_PON_BEN,
	GC1610_PIN_X_RGM_RXCLK,
	GC1610_PIN_X_RGM_RXCTL,
	GC1610_PIN_X_RGM_RXD2,
	GC1610_PIN_X_RGM_RXD3,
	GC1610_PIN_X_RST_OUT,
	GC1610_PIN_X_RX_LOS,
	GC1610_PIN_X_RX_PWRDOWN,
	GC1610_PIN_X_SSP_CS0,
	GC1610_PIN_X_SSP_CS1,
	GC1610_PIN_X_SSP_CS2,
	GC1610_PIN_X_SSP_CS3,
	GC1610_PIN_X_SSP_RXD,
	GC1610_PIN_X_SSP_SCLK,
	GC1610_PIN_X_SSP_TXD,
	GC1610_PIN_X_TX_PWRDOWN,
	GC1610_PIN_X_TX_SD,
	GC1610_PIN_X_UART0_RX,
	GC1610_PIN_X_UART0_TX,
	GC1610_PIN_X_UART1_TX,
	GC1610_PIN_X_XGMII_LOS,
};

static const unsigned pcie_wrap_pins[] = {
	GC1610_PIN_X_PCIe0_RST,
	GC1610_PIN_X_PCIe0_nCLKREQ,
};
static const unsigned pcie_wrap_1_pins[] = {
	GC1610_PIN_X_PCIe1_RST,
	GC1610_PIN_X_PCIe1_nCLKREQ,
};
static const unsigned sbs_usb2_top_pins[] = {
	GC1610_PIN_X_GPIO3,
	GC1610_PIN_X_GPIO4,
};
static const unsigned sbs_usb3_top_pins[] = {
	GC1610_PIN_X_GPIO1,
	GC1610_PIN_X_GPIO5,
	GC1610_PIN_X_GPIO6,
};
static const unsigned sysc_pins[] = {
	GC1610_PIN_X_RST_OUT,
};
static const unsigned tdm_top_pins[] = {
	GC1610_PIN_X_PCM_CLK,
	GC1610_PIN_X_PCM_FS,
	GC1610_PIN_X_PCM_RXD,
	GC1610_PIN_X_PCM_TXD,
};

#define GROUP(gname)					\
	{						\
		.name = #gname,				\
		.pins = gname##_pins,			\
		.npins = ARRAY_SIZE(gname##_pins),	\
	}
	
static const struct ftscu010_pin_group gc1610_groups[] = {
	GROUP(ca53d_subsystem),
	GROUP(clk_gen),
	GROUP(ftiic010),
	GROUP(ftiic010_1),
	GROUP(ftnandc024),
	GROUP(ftspi020),
	GROUP(ftssp010),
	GROUP(ftuart010),
	GROUP(ftuart010_1),
	GROUP(ftuart010_2),
//	GROUP(function mode),
	GROUP(glue),
	GROUP(ftgpio_sel0),
	GROUP(ftgpio_sel1),
	GROUP(isi_inf),
	GROUP(mdio_master),
	GROUP(na),
	GROUP(ontop),
	GROUP(pcie_wrap),
	GROUP(pcie_wrap_1),
	GROUP(sbs_usb2_top),
	GROUP(sbs_usb3_top),
	GROUP(sysc),
	GROUP(tdm_top),
};

/* Pin function groups */
static const char * const ca53d_subsystem_groups[] 	= { "ca53d_subsystem" };
static const char * const clk_gen_groups[] 			= { "clk_gen" };
static const char * const ftiic010_groups[] 			= { "ftiic010" };
static const char * const ftiic010_1_groups[] 			= { "ftiic010_1" };
static const char * const ftnandc024_groups[] 		= { "ftnandc024" };
static const char * const ftspi020_groups[] 			= { "ftspi020" };
static const char * const ftssp010_groups[] 			= { "ftssp010" };
static const char * const ftuart010_groups[] 			= { "ftuart010" };
static const char * const ftuart010_1_groups[] 		= { "ftuart010_1" };
static const char * const ftuart010_2_groups[] 		= { "ftuart010_2" };
//static const char * const function mode_groups[] = { "function mode" };
static const char * const glue_groups[] 				= { "glue" };
static const char * const ftgpio_sel0_groups[] 		= { "ftgpio_sel0" };
static const char * const ftgpio_sel1_groups[] 		= { "ftgpio_sel1" };
static const char * const isi_inf_groups[] 				= { "isi_inf" };
static const char * const mdio_master_groups[] 		= { "mdio_master" };
static const char * const na_groups[] 				= { "na" };
static const char * const ontop_groups[] 			= { "ontop" };
static const char * const pcie_wrap_groups[] 			= { "pcie_wrap" };
static const char * const pcie_wrap_1_groups[] 		= { "pcie_wrap_1" };
static const char * const sbs_usb2_top_groups[] 		= { "sbs_usb2_top" };
static const char * const sbs_usb3_top_groups[] 		= { "sbs_usb3_top" };
static const char * const sysc_groups[] 				= { "sysc" };
static const char * const tdm_top_groups[] 			= { "tdm_top" };

/* Mux functions */
enum{
	GC1610_MUX_CA53D_SUBSYSTEM,
	GC1610_MUX_CLK_GEN,
	GC1610_MUX_FTIIC010,
	GC1610_MUX_FTIIC010_1,
	GC1610_MUX_FTNANDC024,
	GC1610_MUX_FTSPI020,
	GC1610_MUX_FTSSP010,
	GC1610_MUX_FTUART010,
	GC1610_MUX_FTUART010_1,
	GC1610_MUX_FTUART010_2,
//	GC1610_MUX_FUNCTION MODE,
	GC1610_MUX_GLUE,
	GC1610_MUX_FTGPIO010_SEL0,
	GC1610_MUX_FTGPIO010_SEL1,
	GC1610_MUX_ISI_INF,
	GC1610_MUX_MDIO_MASTER,
	GC1610_MUX_NA,
	GC1610_MUX_ONU_TOP,
	GC1610_MUX_PCIE_WRAP,
	GC1610_MUX_PCIE_WRAP_1,
	GC1610_MUX_SBS_USB2_TOP,
	GC1610_MUX_SBS_USB3_TOP,
	GC1610_MUX_SYSC,
	GC1610_MUX_TDM_TOP,
};

#define FUNCTION(fname)					\
	{						\
		.name = #fname,				\
		.groups = fname##_groups,		\
		.ngroups = ARRAY_SIZE(fname##_groups),	\
	}

static const struct ftscu010_pmx_function gc1610_pmx_functions[] = {
	FUNCTION(ca53d_subsystem),
	FUNCTION(clk_gen),
	FUNCTION(ftiic010),
	FUNCTION(ftiic010_1),
	FUNCTION(ftnandc024),
	FUNCTION(ftspi020),
	FUNCTION(ftssp010),
	FUNCTION(ftuart010),
	FUNCTION(ftuart010_1),
	FUNCTION(ftuart010_2),
//	FUNCTION(function mode),
	FUNCTION(glue),
	FUNCTION(ftgpio_sel0),
	FUNCTION(ftgpio_sel1),
	FUNCTION(isi_inf),
	FUNCTION(mdio_master),
	FUNCTION(na),
	FUNCTION(ontop),
	FUNCTION(pcie_wrap),
	FUNCTION(pcie_wrap_1),
	FUNCTION(sbs_usb2_top),
	FUNCTION(sbs_usb3_top),
	FUNCTION(sysc),
	FUNCTION(tdm_top),
};

#define GC1610_PIN(pin, reg, f0, f1, f2, f3)		\
	[GC1610_PIN_ ## pin] = {				\
			.offset = GC1610_PMUR_ ## reg,	\
			.functions = {			\
				GC1610_MUX_ ## f0,	\
				GC1610_MUX_ ## f1,	\
				GC1610_MUX_ ## f2,	\
				GC1610_MUX_ ## f3,	\
			},				\
		}

static struct ftscu010_pin gc1610_pinmux_map[] = {
		/*             pin      reg     	f0              			f1              	f2  				f3 */
	GC1610_PIN(X_CPU_TRSTn,	MFS0 ,	CA53D_SUBSYSTEM,	FTUART010_2,	FTGPIO010_SEL0,	NA),
	GC1610_PIN(X_CPU_TCK,		MFS0 ,	CA53D_SUBSYSTEM,	FTUART010_2,	FTGPIO010_SEL0,	NA),
	GC1610_PIN(X_CPU_TMS,		MFS0 ,	CA53D_SUBSYSTEM,	FTUART010_2,	FTGPIO010_SEL0,	NA),
	GC1610_PIN(X_CPU_TDI,		MFS0 ,	CA53D_SUBSYSTEM,	GLUE,		FTGPIO010_SEL0,	NA),
	GC1610_PIN(X_CPU_TDO,		MFS0 ,	CA53D_SUBSYSTEM,	FTUART010_2,	FTGPIO010_SEL0,	NA),
	GC1610_PIN(X_RGM_TXCLK_IN,MFS0 ,	ONU_TOP,			GLUE,		FTGPIO010_SEL0,	NA),
	GC1610_PIN(X_TX_SD,		MFS0 ,	ONU_TOP,			NA,			FTGPIO010_SEL0,	NA),
	GC1610_PIN(X_RX_LOS,		MFS0 ,	ONU_TOP,			NA,			FTGPIO010_SEL0,	NA),
	GC1610_PIN(X_PON_BEN,		MFS0 ,	ONU_TOP,			NA,			FTGPIO010_SEL0,	NA),
	GC1610_PIN(X_TX_PWRDOWN,	MFS0 ,	ONU_TOP,			NA,			FTGPIO010_SEL0,	NA),
	GC1610_PIN(X_RX_PWRDOWN,	MFS0 ,	ONU_TOP,			NA,			FTGPIO010_SEL0,	NA),
	GC1610_PIN(X_XGMII_LOS,	MFS0 ,	ONU_TOP,			NA,	FTGPIO010_SEL0,	NA),
	GC1610_PIN(X_SPI_SCLK,		MFS0 ,	FTSPI020,			FTNANDC024,	FTGPIO010_SEL0,	NA),
	GC1610_PIN(X_SPI_CS,		MFS0 ,	FTSPI020,			FTNANDC024,	FTGPIO010_SEL0,	NA),
	GC1610_PIN(X_SPI_SIO0,		MFS0 ,	FTSPI020,			FTNANDC024,	FTGPIO010_SEL0,	NA),
	GC1610_PIN(X_SPI_SIO1,		MFS0 ,	FTSPI020,			FTNANDC024,	FTGPIO010_SEL0,	NA),
	GC1610_PIN(X_SPI_SIO2,		MFS1 ,	FTSPI020,			FTNANDC024,	FTGPIO010_SEL0,	NA),
	GC1610_PIN(X_SPI_SIO3,		MFS1 ,	FTSPI020,			FTNANDC024,	FTGPIO010_SEL0,	NA),
	GC1610_PIN(X_RGM_TXCLK,	MFS1 ,	ONU_TOP,			FTNANDC024,	FTGPIO010_SEL0,	NA),
	GC1610_PIN(X_RGM_TXCTL,	MFS1 ,	ONU_TOP,			FTNANDC024,	FTGPIO010_SEL0,	NA),
	GC1610_PIN(X_RGM_TXD0,	MFS1 ,	ONU_TOP,			FTNANDC024,	FTGPIO010_SEL0,	NA),
	GC1610_PIN(X_RGM_TXD1,	MFS1 ,	ONU_TOP,			FTNANDC024,	FTGPIO010_SEL0,	NA),
	GC1610_PIN(X_RGM_TXD2,	MFS1 ,	ONU_TOP,			FTNANDC024,	FTGPIO010_SEL0,	NA),
	GC1610_PIN(X_RGM_TXD3,	MFS1 ,	ONU_TOP,			FTNANDC024,	FTGPIO010_SEL0,	NA),
	GC1610_PIN(X_RGM_RXD0,	MFS1 ,	ONU_TOP,			FTNANDC024,	FTGPIO010_SEL0,	NA),
	GC1610_PIN(X_RGM_RXD1,	MFS1 ,	ONU_TOP,			FTNANDC024,	FTGPIO010_SEL0,	NA),
	GC1610_PIN(X_RGM_RXD2,	MFS1 ,	ONU_TOP,			NA,			FTGPIO010_SEL0,	NA),
	GC1610_PIN(X_RGM_RXD3,	MFS1 ,	ONU_TOP,			NA,			FTGPIO010_SEL0,	NA),
	GC1610_PIN(X_RGM_RXCTL,	MFS1 ,	ONU_TOP,			NA,			FTGPIO010_SEL0,	NA),
	GC1610_PIN(X_RGM_RXCLK,	MFS1 ,	ONU_TOP,			NA,			FTGPIO010_SEL0,	NA),
	GC1610_PIN(X_PCM_CLK,		MFS1 ,	TDM_TOP,			ISI_INF,		FTGPIO010_SEL0,	NA),
	GC1610_PIN(X_PCM_FS,		MFS1 ,	TDM_TOP,			ISI_INF,		FTGPIO010_SEL0,	NA),
	GC1610_PIN(X_PCM_TXD,		MFS2 ,	TDM_TOP,			ISI_INF,		FTGPIO010_SEL1,	NA),
	GC1610_PIN(X_PCM_RXD,		MFS2 ,	TDM_TOP,			ISI_INF,		FTGPIO010_SEL1,	NA),
	GC1610_PIN(X_UART0_RX,		MFS2 ,	FTUART010,			NA,			FTGPIO010_SEL1,	NA),
	GC1610_PIN(X_UART0_TX,		MFS2 ,	FTUART010,			NA,			FTGPIO010_SEL1,	NA),
	GC1610_PIN(X_UART1_RX,		MFS2 ,	FTUART010_1,			ONU_TOP,	FTGPIO010_SEL1,	NA),
	GC1610_PIN(X_UART1_TX,		MFS2 ,	FTUART010_1,			NA,			FTGPIO010_SEL1,	NA),
	GC1610_PIN(X_I2C0_SCL,		MFS2 ,	FTIIC010,			NA,			FTGPIO010_SEL1,	NA),
	GC1610_PIN(X_I2C0_SDA,		MFS2 ,	FTIIC010,			NA,			FTGPIO010_SEL1,	NA),
	GC1610_PIN(X_I2C1_SCL,		MFS2 ,	FTIIC010_1,			ONU_TOP,	FTGPIO010_SEL1,	NA),
	GC1610_PIN(X_I2C1_SDA,		MFS2 ,	FTIIC010_1,			ONU_TOP,	FTGPIO010_SEL1,	NA),
	GC1610_PIN(X_SSP_CS0,		MFS2 ,	FTSSP010,			NA,			FTGPIO010_SEL1,	NA),
	GC1610_PIN(X_SSP_CS1,		MFS2 ,	FTSSP010,			NA,			FTGPIO010_SEL1,	NA),
	GC1610_PIN(X_SSP_CS2,		MFS2 ,	FTSSP010,			NA,			FTGPIO010_SEL1,	NA),
	GC1610_PIN(X_SSP_CS3,		MFS2 ,	FTSSP010,			NA,			FTGPIO010_SEL1,	NA),
	GC1610_PIN(X_SSP_TXD,		MFS2 ,	FTSSP010,			NA,			FTGPIO010_SEL1,	NA),
	GC1610_PIN(X_SSP_RXD,		MFS2 ,	FTSSP010,			NA,			FTGPIO010_SEL1,	NA),
	GC1610_PIN(X_SSP_SCLK,		MFS3 ,	FTSSP010,			NA,			FTGPIO010_SEL1,	NA),
	GC1610_PIN(X_MDC,			MFS3 ,	MDIO_MASTER,		NA,			FTGPIO010_SEL1,	NA),
	GC1610_PIN(X_MDIO,			MFS3 ,	MDIO_MASTER,		NA,			FTGPIO010_SEL1,	NA),
	GC1610_PIN(X_RST_OUT,		MFS3 ,	SYSC,				NA,			FTGPIO010_SEL1,	NA),
	GC1610_PIN(X_PCIe0_RST,		MFS3 ,	PCIE_WRAP,		NA,			FTGPIO010_SEL1,	NA),
	GC1610_PIN(X_PCIe0_nCLKREQ,	MFS3 ,	PCIE_WRAP,		NA,			FTGPIO010_SEL1,	NA),
	GC1610_PIN(X_PCIe1_RST,		MFS3 ,	PCIE_WRAP_1,	NA,			FTGPIO010_SEL1,	NA),
	GC1610_PIN(X_PCIe1_nCLKREQ,	MFS3 ,	PCIE_WRAP_1,	NA,			FTGPIO010_SEL1,	NA),
	GC1610_PIN(X_GPIO0,		MFS3 ,	FTSPI020,			NA,			FTGPIO010_SEL1,	NA),
	GC1610_PIN(X_GPIO1,		MFS3 ,	SBS_USB3_TOP,		NA,			FTGPIO010_SEL1,	NA),
	GC1610_PIN(X_GPIO2,		MFS3 ,	ONU_TOP,			NA,			FTGPIO010_SEL1,	NA),
	GC1610_PIN(X_GPIO3,		MFS3 ,	SBS_USB2_TOP,		NA,			FTGPIO010_SEL1,	NA),
	GC1610_PIN(X_GPIO4,		MFS3 ,	SBS_USB2_TOP,		NA,			FTGPIO010_SEL1,	NA),
	GC1610_PIN(X_GPIO5,		MFS3 ,	SBS_USB3_TOP,		NA,			FTGPIO010_SEL1,	NA),
	GC1610_PIN(X_GPIO6,		MFS3 ,	SBS_USB3_TOP,		NA,			FTGPIO010_SEL1,	NA),
	GC1610_PIN(X_GPIO7,		MFS3 ,	CLK_GEN,			NA,			FTGPIO010_SEL1,	NA),
};

static const struct ftscu010_pinctrl_soc_data gc1610_pinctrl_soc_data = {
	.pins = gc1610_pins,
	.npins = ARRAY_SIZE(gc1610_pins),
	.functions = gc1610_pmx_functions,
	.nfunctions = ARRAY_SIZE(gc1610_pmx_functions),
	.groups = gc1610_groups,
	.ngroups = ARRAY_SIZE(gc1610_groups),
	.map = gc1610_pinmux_map,
};

static int gc1610_pinctrl_probe(struct platform_device *pdev)
{
	return ftscu010_pinctrl_probe(pdev, &gc1610_pinctrl_soc_data);
}

static struct of_device_id faraday_pinctrl_of_match[] = {
	{ .compatible = "ftscu010-pinmux", "pinctrl-GC1610" },
	{ },
};

static struct platform_driver gc1610_pinctrl_driver = {
	.driver = {
		.name = "pinctrl-gc1610",
		.owner = THIS_MODULE,
		.of_match_table = faraday_pinctrl_of_match,
	},
	.probe = gc1610_pinctrl_probe,
	.remove = ftscu010_pinctrl_remove,
};

module_platform_driver(gc1610_pinctrl_driver);

MODULE_AUTHOR("Fu-Tsung Hsu <mark_hs@faraday-tech.com");
MODULE_DESCRIPTION("Faraday GC1610 pinctrl driver");
MODULE_LICENSE("GPL");
